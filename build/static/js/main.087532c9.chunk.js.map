{"version":3,"sources":["azure-storage-blob.ts","authConfig.js","components/SignInButton.jsx","components/SignOutButton.jsx","Geo_logo.png","components/PageLayout.jsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["containerName","process","sasToken","storageAccountName","getBlobsInContainer","containerClient","returnedBlobUrls","listBlobsFlat","blob","push","name","createBlobInContainer","file","blobClient","getBlockBlobClient","options","blobHTTPHeaders","blobContentType","type","uploadBrowserData","uploadFileToBlob","blobService","BlobServiceClient","getContainerClient","createIfNotExists","access","msalConfig","auth","clientId","authority","redirectUri","cache","cacheLocation","storeAuthStateInCookie","loginRequest","scopes","SignInButton","instance","useMsal","className","authCallback","loginPopup","catch","e","console","log","SignOutButton","onClick","logoutPopup","postLogoutRedirectUri","mainWindowRedirectUri","Header","props","isAuthenticated","useIsAuthenticated","role","src","Logo","width","height","id","icon","faUser","color","Main","class","children","PageLayout","App","useState","blobList","setBlobList","fileSelected","setFileSelected","accounts","uploading","setUploading","Math","random","toString","setInputKey","onFileChange","incommingFiles","onFileUpload","blobsInContainer","removeFile","filter","x","dropzoneStyle","background","UploadArea","onChange","value","accept","label","maxFiles","maxFileSize","style","length","map","onDelete","key","info","item","Path","basename","alt","Boolean","window","location","hostname","match","msalInstance","PublicClientApplication","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","error","message"],"mappings":"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","file":"static/js/main.087532c9.chunk.js","sourcesContent":["// ./src/azure-storage-blob.ts\r\n\r\n// <snippet_package>\r\n// THIS IS SAMPLE CODE ONLY - NOT MEANT FOR PRODUCTION USE\r\nimport { BlobServiceClient, ContainerClient} from '@azure/storage-blob';\r\n\r\n// THIS IS SAMPLE CODE ONLY - DON'T STORE TOKEN IN PRODUCTION CODE\r\nconst containerName = `${process.env.REACT_APP_CONTAINER_NAME}`; //\"`tutorial-container`\";\r\nconst sasToken = process.env.REACT_APP_SAS_TOKEN; // || \"sv=2021-06-08&ss=bfqt&srt=sco&sp=rwdlacupiytfx&se=2022-12-28T22:53:41Z&st=2022-12-28T14:53:41Z&spr=https&sig=6clc0kWfhel%2FZxOA%2FAkN2zuVmldyCzD2l3grmcr93Bg%3D\"; // Fill string with your SAS token\r\nconst storageAccountName = process.env.REACT_APP_STORAGE_ACCOUNT_NAME; // || \"reactuploadtest\";  Fill string with your Storage resource name\r\n// </snippet_package>\r\n\r\n// <snippet_isStorageConfigured>\r\n// Feature flag - disable storage feature to app if not configured\r\nexport const isStorageConfigured = () => {\r\n  return (!storageAccountName || !sasToken) ? false : true;\r\n}\r\n// </snippet_isStorageConfigured>\r\n\r\n// <snippet_getBlobsInContainer>\r\n// return list of blobs in container to display\r\nconst getBlobsInContainer = async (containerClient: ContainerClient) => {\r\n  const returnedBlobUrls: string[] = [];\r\n\r\n  // get list of blobs in container\r\n  // eslint-disable-next-line\r\n  for await (const blob of containerClient.listBlobsFlat()) {\r\n    // if image is public, just construct URL\r\n    returnedBlobUrls.push(\r\n      `https://${storageAccountName}.blob.core.windows.net/${containerName}/${blob.name}`\r\n    );\r\n  }\r\n\r\n  return returnedBlobUrls;\r\n}\r\n// </snippet_getBlobsInContainer>\r\n\r\n// <snippet_createBlobInContainer>\r\nconst createBlobInContainer = async (containerClient: ContainerClient, file: File) => {\r\n  \r\n  // create blobClient for container\r\n  const blobClient = containerClient.getBlockBlobClient(file.name);\r\n\r\n  // set mimetype as determined from browser with file upload control\r\n  const options = { blobHTTPHeaders: { blobContentType: file.type } };\r\n\r\n  // upload file\r\n  await blobClient.uploadBrowserData(file, options);\r\n}\r\n// </snippet_createBlobInContainer>\r\n\r\n// <snippet_uploadFileToBlob>\r\nconst uploadFileToBlob = async (file: File | null): Promise<string[]> => {\r\n  if (!file) return [];\r\n\r\n  // get BlobService = notice `?` is pulled out of sasToken - if created in Azure portal\r\n  const blobService = new BlobServiceClient(\r\n    `https://${storageAccountName}.blob.core.windows.net/?${sasToken}`\r\n  );\r\n\r\n  // get Container - full public read access\r\n  const containerClient: ContainerClient = blobService.getContainerClient(containerName);\r\n  await containerClient.createIfNotExists({\r\n    access: 'container',\r\n  });\r\n\r\n  // upload file\r\n  await createBlobInContainer(containerClient, file);\r\n\r\n  // get list of blobs in container\r\n  return getBlobsInContainer(containerClient);\r\n};\r\n// </snippet_uploadFileToBlob>\r\n\r\nexport default uploadFileToBlob;\r\n\r\n","export const msalConfig = {\n    auth: {\n      clientId: `${process.env.REACT_APP_CLIENT_ID}`, //\"c6794e02-3287-4053-979a-5c45704db40b\",\n      authority: `${process.env.REACT_APP_TENANT_ID}`, // This is a URL (e.g. https://login.microsoftonline.com/{your tenant ID}) \n      redirectUri: `${process.env.REACT_APP_REDIRECT_URI}`,\n    },\n    cache: {\n      cacheLocation: \"sessionStorage\", // This configures where your cache will be stored\n      storeAuthStateInCookie: false, // Set this to \"true\" if you are having issues on IE11 or Edge\n    }\n  };\n  \n  // Add scopes here for ID token to be used at Microsoft identity platform endpoints.\n  export const loginRequest = {\n   scopes: [\"User.Read\"]\n  };\n  \n  // Add the endpoints here for Microsoft Graph API services you'd like to use.\n  export const graphConfig = {\n      graphMeEndpoint: \"https://graph.microsoft.com/v1.0\"\n  };","import React from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { loginRequest } from \"../authConfig\";\nimport Button from \"react-bootstrap/Button\";\nimport MicrosoftLogin from \"react-microsoft-login\";\n\n/**\n * Renders a button which, when selected, will open a popup for login\n */\nexport const SignInButton = () => {\n    const { instance } = useMsal();\n\n    const handleLogin = (loginType) => {\n        if (loginType === \"popup\") {\n            instance.loginPopup(loginRequest).catch(e => {\n                console.log(e);\n            });\n        }\n    }\n    return (\n        <MicrosoftLogin className=\"logout\" clientId={process.env.REACT_APP_CLIENT_ID} authCallback={() => handleLogin(\"popup\")} />\n    );\n}","import React from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport Button from \"react-bootstrap/Button\";\nimport 'bulma/css/bulma.min.css';\n\n/**\n * Renders a button which, when selected, will open a popup for logout\n */\nexport const SignOutButton = () => {\n    const { instance } = useMsal();\n\n    const handleLogout = (logoutType) => {\n        if (logoutType === \"popup\") {\n            instance.logoutPopup({\n                postLogoutRedirectUri: \"/\",\n                mainWindowRedirectUri: \"/\" // redirects the top level app after logout\n            });\n        }\n    }\n\n    return (\n        <div  onClick={() => handleLogout(\"popup\")}>Sign out</div>\n    );\n\n}","export default __webpack_public_path__ + \"static/media/Geo_logo.c7423293.png\";","import React from \"react\";\nimport Navbar from \"react-bootstrap/Navbar\";\nimport { useIsAuthenticated } from \"@azure/msal-react\";\nimport { SignInButton } from \"./SignInButton\";\nimport { SignOutButton } from \"./SignOutButton\";\nimport \"../App.css\";\nimport 'bulma/css/bulma.css';\nimport Logo from \"../Geo_logo.png\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUser } from '@fortawesome/free-solid-svg-icons'\n\n/**\n * Renders the navbar component with a sign-in button if a user is not authenticated\n */\n\n\nconst Header = (props) => {\n    const isAuthenticated = useIsAuthenticated();\n\n    return (\n        <div>\n            <nav className=\"navbar\" role=\"navigation\" aria-label=\"main navigation\">\n                <div className=\"navbar-brand\">\n                    <a className=\"navbar-item\" >\n                        <img src={Logo} width=\"112\" height=\"28\" />\n                    </a>\n\n                    <a role=\"button\" className=\"navbar-burger\" aria-label=\"menu\" aria-expanded=\"false\" data-target=\"navbarBasicExample\">\n                        <span aria-hidden=\"true\"></span>\n                        <span aria-hidden=\"true\"></span>\n                        <span aria-hidden=\"true\"></span>\n                    </a>\n                </div>\n\n                <div id=\"navbarBasicExample\" className=\"navbar-menu\">\n                    <div className=\"navbar-start\">\n                        <a className=\"navbar-item\">\n                            Home\n                        </a>\n\n                        <a className=\"navbar-item\">\n                            Documentation\n                        </a>\n\n                        <div className=\"navbar-item has-dropdown is-hoverable\">\n                            <a className=\"navbar-link\">\n                                More\n                            </a>\n\n                            <div className=\"navbar-dropdown\">\n                                <a className=\"navbar-item\">\n                                    About\n                                </a>\n                                <a className=\"navbar-item\">\n                                    Contact\n                                </a>\n                                <a className=\"navbar-item\">\n                                    Report an issue\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"navbar-end\">\n                        <div className=\"navbar-item\">\n                            <div className=\"buttons\">\n                                {isAuthenticated ? \n                                <button className=\"button\">\n                                    <span className=\"icon\">\n                                        <FontAwesomeIcon icon={faUser} color=\"red\" />\n                                    </span>\n                                <span>{props.name}</span>\n                              </button>\n                                : \n                                <div className=\"button is-primary\">\n                                    <strong>Sign up</strong>\n                                </div>}\n                                \n                                <div className=\"button is-light\">\n                                    {isAuthenticated ? <SignOutButton /> : <SignInButton />}\n                                </div>\n\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </nav>\n        </div>\n    )\n}\n\nconst Main = (props) => {\n    return (\n        <div class=\"section\">\n            <div class=\"columns\">\n                <aside class=\"column is-2\">\n                    <nav class=\"menu\">\n                        <p class=\"menu-label\">\n                            General\n                        </p>\n                        <ul class=\"menu-list\">\n                            <li><a class=\"is-active has-background-primary\">Upload</a></li>\n                            <li><a>Option 1</a></li>\n                        </ul>\n                        <p class=\"menu-label\">\n                            Administration\n                        </p>\n                        <ul class=\"menu-list\">\n                            <li><a>Option 0</a></li>\n                            <li>\n                                <a class=\"\">Option 1</a>\n                                <ul>\n                                    <li><a>SubOption 0</a></li>\n                                    <li><a>SubOption 1</a></li>\n                                    <li><a>SubOption 2</a></li>\n                                </ul>\n                            </li>\n                            <li><a>Option 2</a></li>\n                            <li><a>Option 3</a></li>\n                            <li><a>Option 4</a></li>\n                        </ul>\n                        <p class=\"menu-label\">\n                            Accout\n                        </p>\n                        <ul class=\"menu-list\">\n                            <li><a>Option 0</a></li>\n                            <li><a>Option 1</a></li>\n                            <li><a>Option 2</a></li>\n                        </ul>\n                    </nav>\n                </aside>\n\n                <main class=\"column\">\n                    <div class=\"level\">\n                        <div class=\"level-left\">\n                            <div class=\"level-item\">\n                                <div class=\"title\">Upload</div>\n                            </div>\n                        </div>\n                        <div class=\"level-right\">\n                            <div class=\"level-item\">\n                                <button type=\"button\" class=\"button is-small\">\n                                    Some Information/button Here\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"columns is-multiline\">\n                        <div class=\"column\">\n                            <div class=\"b\">\n                                {props.children}\n                            </div>\n                        </div>\n                        \n                        \n                        \n                        \n                    </div>\n\n                    \n                </main>\n            </div>\n        </div>\n    )\n}\n\n\nexport const PageLayout = (props) => {\n\n\n    return (\n        <>\n            <Header {...props} />\n            <Main {...props} />\n            <br />\n            <br />\n\n        </>\n    );\n};\n\n","// ./src/App.tsx\r\n\r\nimport \"./App.css\";\r\nimport React, { useState } from 'react';\r\nimport Path from 'path';\r\nimport uploadFileToBlob, { isStorageConfigured } from './azure-storage-blob';\r\nimport { Dropzone, FileItem } from \"@dropzone-ui/react\";\r\n\r\n// import React from \"react\";\r\nimport { PageLayout } from \"./components/PageLayout\";\r\n// Addition\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport { AuthenticatedTemplate, UnauthenticatedTemplate, useMsal } from \"@azure/msal-react\";\r\nimport { loginRequest } from \"./authConfig\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport { ProfileData } from \"./components/ProfileData\";\r\nimport { callMsGraph } from \"./graph\";\r\n// End addition\r\n\r\n\r\n\r\nfunction ProfileContent() {\r\n  const { instance, accounts } = useMsal();\r\n  const [graphData, setGraphData] = useState(null);\r\n\r\n  const name = accounts[0] && accounts[0].name;\r\n\r\n  function RequestProfileData() {\r\n    const request = {\r\n      ...loginRequest,\r\n      account: accounts[0]\r\n    };\r\n\r\n    // Silently acquires an access token which is then attached to a request for Microsoft Graph data\r\n    instance.acquireTokenSilent(request).then((response) => {\r\n      callMsGraph(response.accessToken).then(response => setGraphData(response));\r\n    }).catch((e) => {\r\n      instance.acquireTokenPopup(request).then((response) => {\r\n        callMsGraph(response.accessToken).then(response => setGraphData(response));\r\n      });\r\n    });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <h5 className=\"card-title\">Welcome {name}</h5>\r\n      {graphData ?\r\n        <ProfileData graphData={graphData} />\r\n        :\r\n        <Button variant=\"secondary\" onClick={RequestProfileData}>Request Profile Information</Button>\r\n      }\r\n    </>\r\n  );\r\n};\r\n\r\n// Previous storage code\r\nconst storageConfigured = isStorageConfigured();\r\n\r\n\r\n\r\n\r\nconst App = (): JSX.Element => {\r\n  // all blobs in container\r\n  const [blobList, setBlobList] = useState<string[]>([]);\r\n\r\n  // current file to upload into container\r\n  const [fileSelected, setFileSelected] = useState<any[]>([]);\r\n\r\n  const { instance, accounts } = useMsal();\r\n  const name = accounts[0] && accounts[0].name;\r\n\r\n  // UI/form management\r\n  const [uploading, setUploading] = useState(false);\r\n  const [inputKey, setInputKey] = useState(Math.random().toString(36));\r\n\r\n  const onFileChange = (incommingFiles: any) => {\r\n    // capture file into state\r\n    setFileSelected(incommingFiles);\r\n  };\r\n\r\n  const onFileUpload = async () => {\r\n    // prepare UI\r\n    setUploading(true);\r\n\r\n    // *** UPLOAD TO AZURE STORAGE ***\r\n    const blobsInContainer: string[] = await uploadFileToBlob(fileSelected[0]);\r\n\r\n    // prepare UI for results\r\n    setBlobList(blobsInContainer);\r\n\r\n    // reset state/form\r\n    setFileSelected([]);\r\n    setUploading(false);\r\n    setInputKey(Math.random().toString(36));\r\n  };\r\n\r\n  // display form\r\n  const DisplayForm = () => (\r\n    <form>\r\n      <input type=\"file\" onChange={onFileChange} key={inputKey || ''} />\r\n      <p>{\"Drag your files here or click in this area.\"}</p>\r\n      <button type=\"submit\" onClick={onFileUpload}>Upload</button>\r\n    </form>\r\n\r\n\r\n  )\r\n\r\n  // display file name and image\r\n  const DisplayImagesFromContainer = () => (\r\n    <div>\r\n      <h2>Container items</h2>\r\n      <ul>\r\n        {blobList.map((item) => {\r\n          return (\r\n            <li key={item}>\r\n              <div>\r\n                {Path.basename(item)}\r\n                <br />\r\n                <img src={item} alt={item} height=\"200\" />\r\n              </div>\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    </div>\r\n  );\r\n\r\n  //End previous storage code\r\n\r\n  const removeFile = (id: any) => {\r\n    setFileSelected(fileSelected.filter((x) => x.id !== id));\r\n  };\r\n\r\n  const dropzoneStyle = {\r\n    background: \"ffffff\"\r\n  }\r\n\r\n  const UploadArea = () => (\r\n    <div className=\"upload-area\">\r\n      <Dropzone\r\n        onChange={onFileChange}\r\n        value={fileSelected}\r\n        accept=\"text/csv\"\r\n        label=\"click or drop your files here\"\r\n        maxFiles={1}\r\n        maxFileSize={104857600}\r\n        style={dropzoneStyle}\r\n      >\r\n        {fileSelected.length > 0 &&\r\n          fileSelected.map((file) => (\r\n            <FileItem\r\n              {...file}\r\n              onDelete={removeFile}\r\n              key={file.id}\r\n              info\r\n            />\r\n          ))}\r\n\r\n      </Dropzone>\r\n      <div className=\"box has-text-centered\">\r\n        <button type=\"submit\" className=\"button is-primary\" onClick={onFileUpload}>Upload File</button>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  // function App() {\r\n  return (\r\n    <PageLayout name={name} >\r\n      <AuthenticatedTemplate>\r\n        \r\n        <div>\r\n          {storageConfigured && !uploading && <UploadArea />}\r\n          {storageConfigured && uploading && <div>Uploading</div>}\r\n          <hr />\r\n          {storageConfigured && blobList.length > 0 && DisplayImagesFromContainer()}\r\n          {!storageConfigured && <div>Storage is not configured.</div>}\r\n        </div>\r\n\r\n      </AuthenticatedTemplate>\r\n\r\n      <UnauthenticatedTemplate>\r\n      </UnauthenticatedTemplate>\r\n    </PageLayout>\r\n  );\r\n  // }\r\n};\r\n\r\nexport default App;","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n/* eslint-disable */\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then((registration) => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then((response) => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then((registration) => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then((registration) => {\r\n        registration.unregister();\r\n      })\r\n      .catch((error) => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n// Additions\r\n// import \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { PublicClientApplication } from \"@azure/msal-browser\";\r\nimport { MsalProvider } from \"@azure/msal-react\";\r\nimport { msalConfig } from \"./authConfig\";\r\n\r\n// Addition\r\nconst msalInstance = new PublicClientApplication(msalConfig);\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <MsalProvider instance={msalInstance}>\r\n            <App />\r\n        </MsalProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}