{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkToIE = exports.getLogger = exports.getScopes = exports.getUserAgentApp = void 0;\nvar msal_1 = require(\"msal\");\nvar CLIENT_ID_REGEX = /[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/;\nvar getUserAgentApp = function (_a) {\n  var clientId = _a.clientId,\n    tenantUrl = _a.tenantUrl,\n    redirectUri = _a.redirectUri,\n    postLogoutRedirectUri = _a.postLogoutRedirectUri,\n    useLocalStorageCache = _a.useLocalStorageCache;\n  if (clientId && CLIENT_ID_REGEX.test(clientId)) {\n    return new msal_1.UserAgentApplication({\n      auth: __assign(__assign(__assign(__assign({}, redirectUri && {\n        redirectUri: redirectUri\n      }), tenantUrl && {\n        authority: tenantUrl\n      }), postLogoutRedirectUri && {\n        postLogoutRedirectUri: postLogoutRedirectUri\n      }), {\n        clientId: clientId,\n        validateAuthority: true,\n        navigateToLoginRequestUrl: false\n      }),\n      cache: __assign({}, useLocalStorageCache ? {\n        cacheLocation: \"localStorage\"\n      } : {\n        cacheLocation: \"sessionStorage\"\n      })\n    });\n  }\n};\nexports.getUserAgentApp = getUserAgentApp;\nvar getScopes = function (graphScopes) {\n  var scopes = graphScopes || [];\n  if (!scopes.find(function (el) {\n    return el.toLowerCase() === \"user.read\";\n  })) {\n    scopes.push(\"user.read\");\n  }\n  return scopes;\n};\nexports.getScopes = getScopes;\nvar getLogger = function (isDebugMode) {\n  return function (name, content, isError) {\n    if (isDebugMode) {\n      var style = \"background-color: \" + (isError ? \"#990000\" : \"#009900\") + \"; color: #ffffff; font-weight: 700; padding: 2px\";\n      console.groupCollapsed(\"MSLogin debug\");\n      console.log(\"%c\" + name, style);\n      content && console.log(content.message || content);\n      console.groupEnd();\n    }\n  };\n};\nexports.getLogger = getLogger;\nvar checkToIE = function () {\n  var ua = window.navigator.userAgent;\n  var msie = ua.indexOf(\"MSIE \");\n  var msie11 = ua.indexOf(\"Trident/\");\n  var msedge = ua.indexOf(\"Edge/\");\n  var isIE = msie > 0 || msie11 > 0;\n  var isEdge = msedge > 0;\n  return isIE || isEdge;\n};\nexports.checkToIE = checkToIE;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;AAAA;AAEA,IAAMA,eAAe,GAAG,8DAA8D;AAE/E,IAAMC,eAAe,GAAG,UAACC,EAY/B;MAXCC,QAAQ;IACRC,SAAS;IACTC,WAAW;IACXC,qBAAqB;IACrBC,oBAAoB;EAQpB,IAAIJ,QAAQ,IAAIH,eAAe,CAACQ,IAAI,CAACL,QAAQ,CAAC,EAAE;IAC9C,OAAO,IAAIM,2BAAoB,CAAC;MAC9BC,IAAI,0CACEL,WAAW,IAAI;QAAEA,WAAW;MAAA,CAAE,CAAC,EAC/BD,SAAS,IAAI;QAAEO,SAAS,EAAEP;MAAS,CAAE,CAAC,EACtCE,qBAAqB,IAAI;QAAEA,qBAAqB;MAAA,CAAE,CAAC;QAEvDH,QAAQ;QACRS,iBAAiB,EAAE,IAAI;QACvBC,yBAAyB,EAAE;MAAK,EACjC;MACDC,KAAK,eACCP,oBAAoB,GACpB;QAAEQ,aAAa,EAAE;MAAc,CAAE,GACjC;QAAEA,aAAa,EAAE;MAAgB,CAAE;KAE1C,CAAC;;AAEN,CAAC;AA/BYC,uBAAe;AAiCrB,IAAMC,SAAS,GAAG,UAACC,WAAsB;EAC9C,IAAMC,MAAM,GAAGD,WAAW,IAAI,EAAE;EAChC,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC,UAACC,EAAU;IAAK,SAAE,CAACC,WAAW,EAAE,KAAK,WAAW;EAAhC,CAAgC,CAAC,EAAE;IAClEH,MAAM,CAACI,IAAI,CAAC,WAAW,CAAC;;EAE1B,OAAOJ,MAAM;AACf,CAAC;AANYH,iBAAS;AAQf,IAAMQ,SAAS,GAAG,UAACC,WAAqB;EAAK,iBAClDC,IAAY,EACZC,OAAa,EACbC,OAAiB;IAEjB,IAAIH,WAAW,EAAE;MACf,IAAMI,KAAK,GAAG,wBACZD,OAAO,GAAG,SAAS,GAAG,SAAS,sDACiB;MAClDE,OAAO,CAACC,cAAc,CAAC,eAAe,CAAC;MACvCD,OAAO,CAACE,GAAG,CAAC,OAAKN,IAAM,EAAEG,KAAK,CAAC;MAC/BF,OAAO,IAAIG,OAAO,CAACE,GAAG,CAACL,OAAO,CAACM,OAAO,IAAIN,OAAO,CAAC;MAClDG,OAAO,CAACI,QAAQ,EAAE;;EAEtB,CAAC;AAdmD,CAcnD;AAdYlB,iBAAS;AAgBf,IAAMmB,SAAS,GAAG;EACvB,IAAMC,EAAE,GAAGC,MAAM,CAACC,SAAS,CAACC,SAAS;EACrC,IAAMC,IAAI,GAAGJ,EAAE,CAACK,OAAO,CAAC,OAAO,CAAC;EAChC,IAAMC,MAAM,GAAGN,EAAE,CAACK,OAAO,CAAC,UAAU,CAAC;EACrC,IAAME,MAAM,GAAGP,EAAE,CAACK,OAAO,CAAC,OAAO,CAAC;EAClC,IAAMG,IAAI,GAAGJ,IAAI,GAAG,CAAC,IAAIE,MAAM,GAAG,CAAC;EACnC,IAAMG,MAAM,GAAGF,MAAM,GAAG,CAAC;EACzB,OAAOC,IAAI,IAAIC,MAAM;AACvB,CAAC;AARY7B,iBAAS","names":["CLIENT_ID_REGEX","getUserAgentApp","_a","clientId","tenantUrl","redirectUri","postLogoutRedirectUri","useLocalStorageCache","test","msal_1","auth","authority","validateAuthority","navigateToLoginRequestUrl","cache","cacheLocation","exports","getScopes","graphScopes","scopes","find","el","toLowerCase","push","getLogger","isDebugMode","name","content","isError","style","console","groupCollapsed","log","message","groupEnd","checkToIE","ua","window","navigator","userAgent","msie","indexOf","msie11","msedge","isIE","isEdge"],"sourceRoot":"","sources":["../src/helpers.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}