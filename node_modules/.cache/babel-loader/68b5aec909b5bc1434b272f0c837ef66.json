{"ast":null,"code":"/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nvar _a;\nimport { __extends } from \"tslib\";\nimport TelemetryEvent from \"./TelemetryEvent\";\nimport { TELEMETRY_BLOB_EVENT_NAMES } from \"./TelemetryConstants\";\nimport { scrubTenantFromUri, hashPersonalIdentifier, prependEventNamePrefix } from \"./TelemetryUtils\";\nexport var EVENT_KEYS = {\n  AUTHORITY: prependEventNamePrefix(\"authority\"),\n  AUTHORITY_TYPE: prependEventNamePrefix(\"authority_type\"),\n  PROMPT: prependEventNamePrefix(\"ui_behavior\"),\n  TENANT_ID: prependEventNamePrefix(\"tenant_id\"),\n  USER_ID: prependEventNamePrefix(\"user_id\"),\n  WAS_SUCESSFUL: prependEventNamePrefix(\"was_successful\"),\n  API_ERROR_CODE: prependEventNamePrefix(\"api_error_code\"),\n  LOGIN_HINT: prependEventNamePrefix(\"login_hint\")\n};\nexport var API_CODE;\n(function (API_CODE) {\n  API_CODE[API_CODE[\"AcquireTokenRedirect\"] = 2001] = \"AcquireTokenRedirect\";\n  API_CODE[API_CODE[\"AcquireTokenSilent\"] = 2002] = \"AcquireTokenSilent\";\n  API_CODE[API_CODE[\"AcquireTokenPopup\"] = 2003] = \"AcquireTokenPopup\";\n  API_CODE[API_CODE[\"LoginRedirect\"] = 2004] = \"LoginRedirect\";\n  API_CODE[API_CODE[\"LoginPopup\"] = 2005] = \"LoginPopup\";\n  API_CODE[API_CODE[\"Logout\"] = 2006] = \"Logout\";\n})(API_CODE || (API_CODE = {}));\nexport var API_EVENT_IDENTIFIER;\n(function (API_EVENT_IDENTIFIER) {\n  API_EVENT_IDENTIFIER[\"AcquireTokenRedirect\"] = \"AcquireTokenRedirect\";\n  API_EVENT_IDENTIFIER[\"AcquireTokenSilent\"] = \"AcquireTokenSilent\";\n  API_EVENT_IDENTIFIER[\"AcquireTokenPopup\"] = \"AcquireTokenPopup\";\n  API_EVENT_IDENTIFIER[\"LoginRedirect\"] = \"LoginRedirect\";\n  API_EVENT_IDENTIFIER[\"LoginPopup\"] = \"LoginPopup\";\n  API_EVENT_IDENTIFIER[\"Logout\"] = \"Logout\";\n})(API_EVENT_IDENTIFIER || (API_EVENT_IDENTIFIER = {}));\nvar mapEventIdentiferToCode = (_a = {}, _a[API_EVENT_IDENTIFIER.AcquireTokenSilent] = API_CODE.AcquireTokenSilent, _a[API_EVENT_IDENTIFIER.AcquireTokenPopup] = API_CODE.AcquireTokenPopup, _a[API_EVENT_IDENTIFIER.AcquireTokenRedirect] = API_CODE.AcquireTokenRedirect, _a[API_EVENT_IDENTIFIER.LoginPopup] = API_CODE.LoginPopup, _a[API_EVENT_IDENTIFIER.LoginRedirect] = API_CODE.LoginRedirect, _a[API_EVENT_IDENTIFIER.Logout] = API_CODE.Logout, _a);\nvar ApiEvent = /** @class */function (_super) {\n  __extends(ApiEvent, _super);\n  function ApiEvent(correlationId, piiEnabled, apiEventIdentifier) {\n    var _this = _super.call(this, prependEventNamePrefix(\"api_event\"), correlationId, apiEventIdentifier) || this;\n    if (apiEventIdentifier) {\n      _this.apiCode = mapEventIdentiferToCode[apiEventIdentifier];\n      _this.apiEventIdentifier = apiEventIdentifier;\n    }\n    _this.piiEnabled = piiEnabled;\n    return _this;\n  }\n  Object.defineProperty(ApiEvent.prototype, \"apiEventIdentifier\", {\n    set: function (apiEventIdentifier) {\n      this.event[TELEMETRY_BLOB_EVENT_NAMES.ApiTelemIdConstStrKey] = apiEventIdentifier;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"apiCode\", {\n    set: function (apiCode) {\n      this.event[TELEMETRY_BLOB_EVENT_NAMES.ApiIdConstStrKey] = apiCode;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"authority\", {\n    set: function (uri) {\n      this.event[EVENT_KEYS.AUTHORITY] = scrubTenantFromUri(uri).toLowerCase();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"apiErrorCode\", {\n    set: function (errorCode) {\n      this.event[EVENT_KEYS.API_ERROR_CODE] = errorCode;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"tenantId\", {\n    set: function (tenantId) {\n      this.event[EVENT_KEYS.TENANT_ID] = this.piiEnabled && tenantId ? hashPersonalIdentifier(tenantId) : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"accountId\", {\n    set: function (accountId) {\n      this.event[EVENT_KEYS.USER_ID] = this.piiEnabled && accountId ? hashPersonalIdentifier(accountId) : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"wasSuccessful\", {\n    get: function () {\n      return this.event[EVENT_KEYS.WAS_SUCESSFUL] === true;\n    },\n    set: function (wasSuccessful) {\n      this.event[EVENT_KEYS.WAS_SUCESSFUL] = wasSuccessful;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"loginHint\", {\n    set: function (loginHint) {\n      this.event[EVENT_KEYS.LOGIN_HINT] = this.piiEnabled && loginHint ? hashPersonalIdentifier(loginHint) : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"authorityType\", {\n    set: function (authorityType) {\n      this.event[EVENT_KEYS.AUTHORITY_TYPE] = authorityType.toLowerCase();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ApiEvent.prototype, \"promptType\", {\n    set: function (promptType) {\n      this.event[EVENT_KEYS.PROMPT] = promptType.toLowerCase();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return ApiEvent;\n}(TelemetryEvent);\nexport default ApiEvent;","map":{"version":3,"mappings":"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","names":["TelemetryEvent","TELEMETRY_BLOB_EVENT_NAMES","scrubTenantFromUri","hashPersonalIdentifier","prependEventNamePrefix","EVENT_KEYS","AUTHORITY","AUTHORITY_TYPE","PROMPT","TENANT_ID","USER_ID","WAS_SUCESSFUL","API_ERROR_CODE","LOGIN_HINT","API_CODE","API_EVENT_IDENTIFIER","mapEventIdentiferToCode","_a","AcquireTokenSilent","AcquireTokenPopup","AcquireTokenRedirect","LoginPopup","LoginRedirect","Logout","__extends","correlationId","piiEnabled","apiEventIdentifier","_super","_this","apiCode","Object","ApiEvent","event","ApiTelemIdConstStrKey","ApiIdConstStrKey","uri","toLowerCase","errorCode","tenantId","accountId","wasSuccessful","loginHint","authorityType","promptType"],"sourceRoot":"","sources":["../../src/telemetry/ApiEvent.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}